<uml:diagram xmlns:uml="http://ideanest.com/dscribe/ns/uml" diagram="d1-1234" kind="class" xml:id="_r-cd.m1-1235.2.">
    <uml:class depicts="j1-267" xml:id="_r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3.">
        <uml:blockname xml:id="_r-ccn.j1-267._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..2.">Mod</uml:blockname>
        <uml:compartment kind="attributes" xml:id="_r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1.">
            <uml:attribute depicts="j1-268" xml:id="_r-cfta.j1-268._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>LOG</uml:name>
                    <uml:type>org.apache.log4j.Logger</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-269" xml:id="_r-cfta.j1-269._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>MOD_NAMESPACE</uml:name>
                    <uml:type>org.exist.fluent.NamespaceMap</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-270" xml:id="_r-cfta.j1-270._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>EMPTY_NAMESPACES</uml:name>
                    <uml:type>org.exist.fluent.NamespaceMap</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-271" xml:id="_r-cfta.j1-271._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>rule</uml:name>
                    <uml:type>com.ideanest.dscribe.mixt.Rule</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-272" xml:id="_r-cfta.j1-272._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>stage</uml:name>
                    <uml:type>int</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-273" xml:id="_r-cfta.j1-273._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>parent</uml:name>
                    <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-274" xml:id="_r-cfta.j1-274._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>previouslyResolved</uml:name>
                    <uml:type>boolean</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-275" xml:id="_r-cfta.j1-275._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>boundVariables</uml:name>
                    <uml:type>java.util.Set</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-276" xml:id="_r-cfta.j1-276._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>references</uml:name>
                    <uml:type>java.util.List</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-277" xml:id="_r-cfta.j1-277._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>seg</uml:name>
                    <uml:type>com.ideanest.dscribe.mixt.Seg</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-278" xml:id="_r-cfta.j1-278._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>node</uml:name>
                    <uml:type>org.exist.fluent.Node</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-279" xml:id="_r-cfta.j1-279._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>supplementQuery</uml:name>
                    <uml:type>org.exist.fluent.QueryService</uml:type>
                </uml:var>
            </uml:attribute>
            <uml:attribute depicts="j1-280" xml:id="_r-cfta.j1-280._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>self</uml:name>
                    <uml:type>Shim</uml:type>
                </uml:var>
            </uml:attribute>
        </uml:compartment>
        <uml:compartment kind="operations" xml:id="_r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2.">
            <uml:operation depicts="j1-281" xml:id="_r-cmto.j1-281._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>Mod</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>rule</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Rule</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
            <uml:operation depicts="j1-282" xml:id="_r-cmto.j1-282._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>Mod</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>parent</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
            <uml:operation depicts="j1-286" xml:id="_r-cmto.j1-286._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>initDefaultShim</uml:name>
                <uml:args/>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-287" xml:id="_r-cmto.j1-287._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>binder</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>varName</uml:name>
                        <uml:type>org.exist.fluent.QName</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-288" xml:id="_r-cmto.j1-288._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>variableBindings</uml:name>
                <uml:args/>
                <uml:type>java.util.Map</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-289" xml:id="_r-cmto.j1-289._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>globalScope</uml:name>
                <uml:args/>
                <uml:type>org.exist.fluent.QueryService</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-290" xml:id="_r-cmto.j1-290._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>scope</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>qs</uml:name>
                        <uml:type>org.exist.fluent.QueryService</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>org.exist.fluent.QueryService</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-291" xml:id="_r-cmto.j1-291._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>prepScopeClone</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>qs</uml:name>
                        <uml:type>org.exist.fluent.QueryService</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>org.exist.fluent.QueryService</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-292" xml:id="_r-cmto.j1-292._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>bindVariable</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>name</uml:name>
                        <uml:type>org.exist.fluent.QName</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>value</uml:name>
                        <uml:type>org.exist.fluent.Resource</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-293" xml:id="_r-cmto.j1-293._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>seg</uml:name>
                <uml:args/>
                <uml:type>com.ideanest.dscribe.mixt.Seg</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-294" xml:id="_r-cmto.j1-294._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>node</uml:name>
                <uml:args/>
                <uml:type>org.exist.fluent.Node</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-295" xml:id="_r-cmto.j1-295._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>key</uml:name>
                <uml:args/>
                <uml:type>java.lang.String</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-296" xml:id="_r-cmto.j1-296._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>supplementQuery</uml:name>
                <uml:args/>
                <uml:type>org.exist.fluent.QueryService</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-297" xml:id="_r-cmto.j1-297._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>workspace</uml:name>
                <uml:args/>
                <uml:type>org.exist.fluent.Folder</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-298" xml:id="_r-cmto.j1-298._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>references</uml:name>
                <uml:args/>
                <uml:type>java.util.List</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-299" xml:id="_r-cmto.j1-299._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>nearest</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>clazz</uml:name>
                        <uml:type>java.lang.Class</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>T</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-300" xml:id="_r-cmto.j1-300._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>nearestAncestorOrSelfImplementing</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>clazz</uml:name>
                        <uml:type>java.lang.Class</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-301" xml:id="_r-cmto.j1-301._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>resolveChildren</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>block</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Block</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>lastBlock</uml:name>
                        <uml:type>boolean</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>touchedScope</uml:name>
                        <uml:type>org.exist.fluent.QueryService</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>int</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-302" xml:id="_r-cmto.j1-302._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>deriveChild</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>block</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Block</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>key</uml:name>
                        <uml:type>java.lang.String</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-303" xml:id="_r-cmto.j1-303._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>restoreChild</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>block</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Block</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>modNode</uml:name>
                        <uml:type>org.exist.fluent.Node</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-304" xml:id="_r-cmto.j1-304._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>restore</uml:name>
                <uml:args/>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-305" xml:id="_r-cmto.j1-305._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>setNode</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>myNode</uml:name>
                        <uml:type>org.exist.fluent.Node</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-306" xml:id="_r-cmto.j1-306._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>affectedIds</uml:name>
                <uml:args/>
                <uml:type>java.util.List</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-307" xml:id="_r-cmto.j1-307._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>verify</uml:name>
                <uml:args/>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-308" xml:id="_r-cmto.j1-308._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>analyze</uml:name>
                <uml:args/>
                <uml:type>org.exist.fluent.QueryService.QueryAnalysis</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-309" xml:id="_r-cmto.j1-309._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>toString</uml:name>
                <uml:args/>
                <uml:type>java.lang.String</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-310" xml:id="_r-cmto.j1-310._r-ccc._r-cctd.m1-1236.j1-267._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>bootstrap</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>rule</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Rule</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
            </uml:operation>
        </uml:compartment>
    </uml:class>
    <uml:class depicts="j1-667" xml:id="_r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3.">
        <uml:blockname xml:id="_r-ccn.j1-667._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..2.">RuleBaseException</uml:blockname>
        <uml:compartment kind="attributes" xml:id="_r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-1."/>
        <uml:compartment kind="operations" xml:id="_r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-2.">
            <uml:operation depicts="j1-668" xml:id="_r-cmto.j1-668._r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>RuleBaseException</uml:name>
                <uml:args/>
            </uml:operation>
            <uml:operation depicts="j1-669" xml:id="_r-cmto.j1-669._r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>RuleBaseException</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>message</uml:name>
                        <uml:type>java.lang.String</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
            <uml:operation depicts="j1-670" xml:id="_r-cmto.j1-670._r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>RuleBaseException</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>message</uml:name>
                        <uml:type>java.lang.String</uml:type>
                    </uml:var>
                    <uml:var>
                        <uml:name>cause</uml:name>
                        <uml:type>java.lang.Throwable</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
            <uml:operation depicts="j1-671" xml:id="_r-cmto.j1-671._r-ccc._r-cctd.m1-1283.j1-667._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>RuleBaseException</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>cause</uml:name>
                        <uml:type>java.lang.Throwable</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
        </uml:compartment>
    </uml:class>
    <uml:class depicts="j1-1032" xml:id="_r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3.">
        <uml:blockname xml:id="_r-ccn.j1-1032._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..2.">WithAnySomeBlock</uml:blockname>
        <uml:compartment kind="attributes" xml:id="_r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-1.">
            <uml:attribute depicts="j1-1033" xml:id="_r-cfta.j1-1033._r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-1..2.">
                <uml:var>
                    <uml:name>optional</uml:name>
                    <uml:type>boolean</uml:type>
                </uml:var>
            </uml:attribute>
        </uml:compartment>
        <uml:compartment kind="operations" xml:id="_r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-2.">
            <uml:operation depicts="j1-1034" xml:id="_r-cmto.j1-1034._r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>WithAnySomeBlock</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>def</uml:name>
                        <uml:type>org.exist.fluent.Node</uml:type>
                    </uml:var>
                </uml:args>
            </uml:operation>
            <uml:operation depicts="j1-1035" xml:id="_r-cmto.j1-1035._r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>resolve</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>modBuilder</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Mod.Builder</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>void</uml:type>
            </uml:operation>
            <uml:operation depicts="j1-1036" xml:id="_r-cmto.j1-1036._r-ccc._r-cctd.m1-1338.j1-1032._r-cd.m1-1235.2..3..1-2..2.">
                <uml:name>createSeg</uml:name>
                <uml:args>
                    <uml:var>
                        <uml:name>mod</uml:name>
                        <uml:type>com.ideanest.dscribe.mixt.Mod</uml:type>
                    </uml:var>
                </uml:args>
                <uml:type>com.ideanest.dscribe.mixt.Seg</uml:type>
            </uml:operation>
        </uml:compartment>
    </uml:class>
</uml:diagram>